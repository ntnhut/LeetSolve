
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Perfect Squares - LeetSolve</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#perfect-squares" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="LeetSolve" class="md-header__button md-logo" aria-label="LeetSolve" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LeetSolve
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Perfect Squares
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="LeetSolve" class="md-nav__button md-logo" aria-label="LeetSolve" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    LeetSolve
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Arrays
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Arrays
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Arrays/2_Add_Two_Numbers.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Strings
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Strings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Strings/3_Longest_Substring_Without_Repeating_Characters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 Longest Substring Without Repeating Characters
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-statement" class="md-nav__link">
    <span class="md-ellipsis">
      Problem statement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problem statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-4" class="md-nav__link">
    <span class="md-ellipsis">
      Example 4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Constraints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution-1-dynamic-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 1: Dynamic Programming
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solution 1: Dynamic Programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-4_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example 4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Complexity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution-2-number-theory" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 2: Number Theory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solution 2: Number Theory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-4_2" class="md-nav__link">
    <span class="md-ellipsis">
      Example 4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code_1" class="md-nav__link">
    <span class="md-ellipsis">
      Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complexity_1" class="md-nav__link">
    <span class="md-ellipsis">
      Complexity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution-3-further-performance-improvement" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 3: Further performance improvement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solution 3: Further performance improvement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code_2" class="md-nav__link">
    <span class="md-ellipsis">
      Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complexity_2" class="md-nav__link">
    <span class="md-ellipsis">
      Complexity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="perfect-squares">Perfect Squares</h1>
<h2 id="problem-statement"><a href="https://leetcode.com/problems/perfect-squares/">Problem statement</a></h2>
<p>Given an integer <code>n</code>, return the least number of perfect square numbers that sum to <code>n</code>.</p>
<p>A <strong>perfect square</strong> is an integer that is the square of an integer; in other words, it is the product of some integer with itself. For example, <code>1</code>, <code>4</code>, <code>9</code>, and <code>16</code> are perfect squares while <code>3</code> and <code>11</code> are not.</p>
<h3 id="example-1">Example 1</h3>
<pre><code class="language-text">Input: n = 9
Output: 1
Explanation: 9 is already a perfect square.
</code></pre>
<h3 id="example-2">Example 2</h3>
<pre><code class="language-text">Input: n = 13
Output: 2
Explanation: 13 = 4 + 9.
</code></pre>
<h3 id="example-3">Example 3</h3>
<pre><code class="language-text">Input: n = 7
Output: 4
Explanation: 7 = 4 + 1 + 1 + 1.
</code></pre>
<h3 id="example-4">Example 4</h3>
<pre><code class="language-text">Input: n = 12
Output: 3
Explanation: 12 = 4 + 4 + 4.
</code></pre>
<h3 id="constraints">Constraints</h3>
<ul>
<li><code>1 &lt;= n &lt;= 10^4</code>.</li>
</ul>
<h2 id="solution-1-dynamic-programming">Solution 1: Dynamic Programming</h2>
<p>Let us call the function to be computed <code>numSquares(n)</code>, which calculates the least number of perfect squares that sum to <code>n</code>.</p>
<p>Here are the findings.
1. If <code>n</code> is already a perfect square then <code>numSquares(n) = 1</code>.
2. Otherwise, it could be written as <code>n = 1 + (n-1)</code>, or <code>n = 4 + (n-4)</code>, or <code>n = 9 + (n-9)</code>, etc. which means <code>n</code> is a sum of a perfect square (<code>1, 4</code> or <code>9</code>, etc.) and another number <code>m &lt; n</code>. That leads to the problems <code>numSquares(m)</code> of smaller values <code>m</code>.
3. If you have gotten the results of the smaller problems <code>numSquares(n-1)</code>, <code>numSquares(n-4)</code>, <code>numSquares(n-9)</code>, etc. then <code>numSquares(n) = 1 + the minimum of those results</code>.</p>
<h3 id="example-4_1">Example 4</h3>
<p><code>n = 12</code> is not a perfect square. It can be written as <code>n = 1 + 11 = 4 + 8 = 9 + 3</code>.
- For <code>m = 11</code>, it is not a perfect square and can be written as <code>m = 1 + 10 = 4 + 7 = 9 + 2</code>.
- For <code>m = 8</code>, it is not a perfect square and can be written as <code>m = 1 + 7 = 4 + 4</code> (matched). You get <code>numSquares(8) = 2</code>.
- For <code>m = 3</code>, it is not a perfect square and can be written as <code>m = 1 + 2</code>.</p>
<p>You can continue to compute <code>numSquares(m)</code> for other values <code>m</code> in this recursive process. But you can see the case of <code>m = 8</code> was already the best solution. And <code>numSquares(12) = 1 + numSquares(8) = 1 + 2 = 3</code>, which is the case of <code>n = 12 = 4 + 4 + 4</code>.</p>
<p>To improve runtime, you can apply <em>dynamic programming</em> to cache the <code>numSquares(n)</code> that you have computed.</p>
<h3 id="code">Code</h3>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;cmath&gt;
#include &lt;unordered_map&gt;
using namespace std;
//! @return         the least number of perfect squares that sum to n
//! @param[out] ns  a map stores all intermediate results
int nsq(int n, unordered_map&lt;int, int&gt;&amp; ns) {
    auto it = ns.find(n);
    if (it != ns.end()) {
        return it-&gt;second;
    }
    const int sq = sqrt(n);
    if (sq * sq == n) {
        // n is already a perfect square
        ns[n] = 1;
        return 1;
    }
    // if n is written as 1 + 1 + .. + 1,
    // maximum of result is n
    int result = n;
    // finding the minimum nsq(n - i*i) across all i &lt;= sqrt(n)
    for (int i = 1; i &lt;= sq; i++) {
        // 
        result = min(result, nsq(n - i*i, ns));
    }
    // write n as imin^2 + (n - imin^2)
    ns[n] = result + 1;
    return ns[n];
}
int numSquares(int n) {
    unordered_map&lt;int, int&gt; ns;
    return nsq(n, ns);
}
int main() {
    cout &lt;&lt; numSquares(12) &lt;&lt; endl;
    cout &lt;&lt; numSquares(13) &lt;&lt; endl;
}
</code></pre>
<pre><code class="language-text">Output:
3
2
</code></pre>
<p>The key idea of this algorithm is to build the solution incrementally, starting from the smallest perfect squares, and use memoization to store and retrieve intermediate results. By doing this, it efficiently finds the minimum number of perfect squares required to sum up to <code>n</code>. </p>
<h3 id="complexity">Complexity</h3>
<ul>
<li>Runtime: <code>O(n*sqrt(n)) = O(n^(3/2))</code> due to the nested loops and recursive calls.</li>
<li>Extra space: <code>O(n)</code>.</li>
</ul>
<h2 id="solution-2-number-theory">Solution 2: Number Theory</h2>
<p>The dynamic programming solution above is good enough. But for those who are interested in Algorithmic Number Theory, there is a very interesting theorem that can solve the problem directly without recursion.</p>
<p>It is called <a href="https://en.wikipedia.org/wiki/Lagrange%27s_four-square_theorem">Lagrange's Four-Square Theorem</a>, which states</p>
<blockquote>
<p><em>every natural number can be represented as the sum of four integerÂ squares.</em></p>
</blockquote>
<p>It was proven by Lagrange in 1770.</p>
<h3 id="example-4_2">Example 4</h3>
<p><code>n = 12 = 4 + 4 + 4 + 0</code> or <code>12 = 1 + 1 + 1 + 9</code>.</p>
<p>Applying to our problem, <strong><code>numSquares(n)</code> can only be 1, 2, 3, or 4. Not more.</strong></p>
<p>It turns into the problem of</p>
<blockquote>
<p><em>identifying when <code>numSquares(n)</code> returns 1, 2, 3, or 4.</em></p>
</blockquote>
<p>Here are the cases.
1. If <code>n</code> is a perfect square, <code>numSquares(n) = 1</code>.
2. There is another theorem, <a href="https://en.wikipedia.org/wiki/Legendre%27s_three-square_theorem">Legendre's Three-Square Theorem</a>, which states that
<code>numSquares(n)</code> cannot be 1, 2, or 3 if <code>n</code> can be expressed as</p>
<p>$$
n = 4^a(8\cdot b + 7),
$$</p>
<p>where $a$, $b$ are nonnegative integers. </p>
<p>In other words, <code>numSquares(n) = 4</code> if <code>n</code> is of this form.</p>
<h3 id="example-3_1">Example 3</h3>
<p>$n = 7 = 4^0(8\cdot 0 + 7)$. It can only be written as <code>7 = 4 + 1 + 1 + 1</code>.</p>
<h3 id="code_1">Code</h3>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;cmath&gt;
using namespace std;
bool isSquare(int n) {
    int sq = sqrt(n);
    return sq * sq == n;
}
int numSquares(int n) {
    if (isSquare(n)) {
        return 1;
    }
    // Legendre's three-square theorem
    int m = n;
    while (m % 4 == 0) {
        m /= 4;
    }
    if (m % 8 == 7) {
        return 4;
    }
    const int sq = sqrt(n);
    for (int i = 1; i &lt;= sq; i++) {
        if (isSquare(n - i*i)) {
            return 2;
        }
    }
    return 3;
}
int main() {
    cout &lt;&lt; numSquares(12) &lt;&lt; endl;
    cout &lt;&lt; numSquares(13) &lt;&lt; endl;
}
</code></pre>
<pre><code class="language-text">Output:
3
2
</code></pre>
<p>This solution finds the minimum number of perfect squares required to sum up to the given integer <code>n</code> by first applying mathematical properties and Legendre's three-square theorem to simplify the problem and then using a loop to find possible combinations of two perfect squares. </p>
<h3 id="complexity_1">Complexity</h3>
<ul>
<li>Runtime: <code>O(sqrt(n)) = O(n^(1/2))</code>, and it does not require dynamic programming or memoization.</li>
<li>Extra space: <code>O(1)</code>.</li>
</ul>
<h2 id="solution-3-further-performance-improvement">Solution 3: Further performance improvement</h2>
<p>Lagrange's Four-Square Theorem and Legendre's Three-Square Theorem are so powerful to solve this problem. But you can still do a little more algebra to improve further the runtime of the implementation above.</p>
<p>Instead of looping over <code>sqrt(n)</code> in the final <code>for</code> loop, you can prove that this loop over <code>sqrt(m)</code> is enough. That will improve runtime a lot since <code>m</code> is much less than <code>n</code>.</p>
<p>Let <code>m</code> be the reduced value of <code>n</code> after the Legendre's <code>while</code> loop. It satisfies</p>
<p>$$
n = 4^a \cdot m.
$$</p>
<p>We will prove that <code>numSquares(n) = numSquares(m)</code>.</p>
<p>In fact, if <code>m</code> is written as $m = x^2 + y^2 + z^2$, where $x$, $y$, $z$ are nonnegative integers. Then</p>
<p>$$
n = 4^a \cdot m = (2^a)^2 \cdot m = (2^a \cdot x)^2 + (2^a \cdot y)^2 + (2^a \cdot z)^2.
$$</p>
<p>In other words, <code>numSquares(n) = numSquares(m)</code>.</p>
<p>Now you can change directly the value <code>n</code> during the Legendre's <code>while</code> loop without affecting the final result. </p>
<h3 id="code_2">Code</h3>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;cmath&gt;
using namespace std;
bool isSquare(int n) {
    int sq = sqrt(n);
    return sq * sq == n;
}
int numSquares(int n) {
    if (isSquare(n)) {
        return 1;
    }
    // Legendre's three-square theorem
    while (n % 4 == 0) {
        n /= 4;
    }
    if (n % 8 == 7) {
        return 4;
    }
    const int sq = sqrt(n);
    for (int i = 1; i &lt;= sq; i++) {
        if (isSquare(n - i*i)) {
            return 2;
        }
    }
    return 3;
}
int main() {
    cout &lt;&lt; numSquares(12) &lt;&lt; endl;
    cout &lt;&lt; numSquares(13) &lt;&lt; endl;
}
</code></pre>
<pre><code class="language-text">Output:
3
2
</code></pre>
<h3 id="complexity_2">Complexity</h3>
<ul>
<li>Runtime: <code>O(sqrt(n)) = O(n^(1/2))</code>.</li>
<li>Extra space: <code>O(1)</code>.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<ul>
<li>The title of this coding challenge (<em>Perfect squares</em>) gives you a hint it is more about mathematics than coding technique.</li>
<li>It is amazing from Lagrange's Four-Square Theorem there are only four possibilities for the answer to the problem. Not many people knowing it.</li>
<li>You can get an optimal solution to a coding problem when you know something about the mathematics behind it.</li>
</ul>
<p>Hope you learn something interesting from this code challenge.</p>
<p><em>Have fun with coding and mathematics!</em></p>
<h2 id="exercise">Exercise</h2>
<ul>
<li><a href="https://leetcode.com/problems/ways-to-express-an-integer-as-sum-of-powers/">Ways to Express an Integer as Sum of Powers</a>.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>